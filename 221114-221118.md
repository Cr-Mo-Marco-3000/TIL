# 221114-221118

## 221114

### 1. 주말동안 완성한 Feed & Comment Layout에 API 입히기

- 더미데이터를 렌더링하는 방식으로 이루어져 있던 피드와 댓글 부분에 API를 입혔다.

- 단순히 처음 스크린이 렌더링될 때 useEffect를 입혀서 동작하게 하는 방식으로는 생각했던 대로 구동이 불가능했다.
  
  - 웹에서와는 달리 컴포넌트가 다시 부착되는 방식이 아니라서, useEffect를 써도 피드 페이지로 되돌아오면 백에 요청을 다시 보내지 않았다.
  
  - 이를 해결하기 위해 여러 가지 방법을 썼다.
    
    1. react navigation의 useIsFocused를 써서, 특정 탭이 포커스 될 때마다 리스트를 재렌더링하게 하기
    
    2. 위 방법으로는 Modal로 구현한 댓글 보기를 갔다 올 때는 재렌더링이 되지 않아서, 댓글을 submit한 후에는 댓글 리스트를 렌더링시키고, 이후 뒤로가기 버튼으로 feed페이지를 보러 나갈 때 feed가 재렌더링 되게 했다.
    
    3. 다른 경우의 수는, 주로 Stack Navigation을 써서 구현했기 때문에  useIfFocused가 정상 작동할 것 같다.

- 그런데 오류가 났다.
  
  1. 처음 댓글을 보러 들어간 페이지에서, 페이지를 한 번 클릭해야 터치가 제대로 되는 문제가 있었다.
     
     - TextInput에 AutoFocus를 달아놓아서 생긴 문제였다
     
     - 조금 헤매다 해결
  
  2. useContext로 context에 저장해 놓은 challengeId가 axios에 변수로써 들어가지 못하는 문제가 있었다.
     
     1. 처음엔, API Data key 오입력 이슈(userId 대신 userID를 넣었다던가)인줄 알았는데 그런 문제가 아니었다.
     
     2. 그 이후에는 혜림이가 알려준 대로, context를 useEffect에 넣어서 해결하려 했는데, useEffect가 재실행되어 Axios 요청이 간 후에도, FlatList에 제대로 렌더링이 되지 않았다.
     
     3. 이 문제를 해결하기 위해서는, ExtraData Prop을 이용해야 할 것 같은데, 이 부분은 내일 하는걸로...

## 2. 다른 작업들

- 챌린지 입장 모달을 keyboardavoidingview를 써서 키보드 반응형으로 바꾸기

- 이것저것 했는데 기억이...



### 3. .env 내부의 환경변수들이 React Native 프로젝트 안에서 제대로 import되지 않는 문제 해결

- 오늘은 잠을 잘 잘 수 있겠다.

- 지금까지 팀원들 중 여러 명이 Google Login을 시도하다 겪은 문제를 해결했다.
  
  - 특정 팀원은 프론트쪽에 접근을 못해 작업에 불편을 겪고 있었는데, 오늘 부로 정상 접근할 수 있게 되었다.

- 버그 설명
  
  - expo를 통해 Google Login을 하기 위해서는 redirect url이나, 여러 key가 필요한데, 파일 내부에서 정상적으로 import 했는데도 불구하고 정상적으로 인식되지 않았다.
  
  - 특이하게도, console.log()등으로 변수를 한번 찍고 동작시키면 되는 경우도 있었다.
  
  - 똑같은 git 버전을 썼는데, 어떤 사람은 오류가 나지 않고, 어떤 사람은 오류가 나고, 심지어 새로 pull을 받은 후 오류가 나는 등 괴상한 오류였다.

- 해결방법
  
  - 결론적으로는(아마도), JavaScript function의 호이스팅 이슈였던 것 같다.
  
  - 환경변수를 import하는 컴포넌트(GoogleButton.js) 에서 컴포넌트를 선언할 때, 함수 표현식(`const myFunc = () => {}`)형태가 아니라 함수 선언식(`function myFunc () {}`) 형태로 선언해 놓아었는데, React가 구동되고 컴포넌트들이 렌더링되는 과정에서 환경변수가 import 되기 전에 컴포넌트 함수가 호이스팅되어 실행되는 문제가 발생한 것으로 추정된다.
    
    - 환경변수를 import한 googlebutton.js 컴포넌트와 app.js를(얘는 필요했는지 모르지만) 함수 선언식에서 함수 표현식으로 바꾸었더니 정상적으로 동작했다.
  
  - 얼마 전에 본 유튜브 영상이 큰 도움이 되었다.


