# 함수

## 1. 함수란?

C 프로그램은 함수의 집합이다.

일반적인 응용프로그램은 관련이 있는 함수의 집합니다.

**함수란 어떤 기능을 수행하는 독립적인 실행단위이다.**

가독성과 재사용성을 위해 함수를 만든다.

함수는 계층적으로 호출될 수 있으며, 구조적(Structured) 프로그래밍이란 함수 단위로 필요할때마다 함수를 호출하여 작업을 처리하는 구조를 말한다.

### 1. 함수 작성과 호출

- main() 함수가 가장 먼저 자동 실행된다.
  - main() 함수는 가장 먼저 실행되고, 가장 마지막에 끝나는 함수이다.
- 부모함수의 호출에 자식함수는 실행되며, 자식함수는 자신의 블록을 실행한 후 종료되면 자신을 호출한 부모함수로 복귀한다.
  - 부모함수는 이후 자신의 코드를 계속 실행한다.
- 함수의 매개변수는 최대 
- 함수는 다음과 같이 구성된다.

```c
void func(void) // 함수의 헤더(함수의 형태, 원형(프로토타입))
{
    print("I"); // 함수의 바디(함수 실행부)
}
```



## 2. 함수의 동작원리

- 함수는 전달인자를 가질 수 있으며, 값을 반환한다.

### 1. 지역 변수

- C에서의 함수는 서로 다른 블록으로 취급된다. 함수에서 다룰 수 있는 변수는 기본적으로는 자신의 블록 안에 있는 것들로 한정된다. 스코프에 대한 자세한 내용은 변수쪽을 참조하자.

### 2. 함수의 전달 인자

- 함수의 인자는 전달할수도, 전달하지 않을 수도 있다.
- 함수의 선언과 정의, 사용은 다음과 같다.
  - 선언
    - `반환형 함수명(매개변수자료형 매개변수, ...)`;
    - 함수의 원형(형식)을 명시
  - 정의
    - `반환형 함수명(매개변수자료형 매개변수) { ... return 반환값; }`
    - 함수를 실행하기 위한 실행부
  - 사용
    - `함수명(전달인자);`
  
- 반환값이 없을 때는 선언 시 반환형에 void를 넣어 주면 되고, 매개변수가 없을 경우 `()` 안에 void를 넣어주어야 한다.



#### 참고: C와 C++에서의 매개변수 공백과 void

C++에서는 매개변수를 비워 두든, void를 넣든 둘 다 매개변수가 없다는 의미이지만 C에서는 다르다. void는 매개변수가 없다는 뜻이고, 비워놓는 것은 확정되지 않은 숫자의 매개변수를 받는다는 것이다. 따라서 의미를 명확히 하기 위해, **매개변수가 없을 경우에는 void를 넣는 것이 바람직하다.**



#### 참고: main() 함수의 반환형

**C에서 공식적으로 권장하는 `main()`함수의 반환형은 int이며, 반환값을 명시하지 않은 함수의 반환형은 int로 반환되는 것으로 간주됨에도 불구하고, 이를 직접적으로 명시할것을 요구한다.** `void main()`은 메인 함수가 어떤 값도 반환하지 않는다는 뜻인데, 운영체제는  프로그램의 리턴값을 받아서 프로그램이 왜 종료되었는지 판단한다. 정상 종료는 리턴값이 0이므로, 운영체제에게 올바른 신호를 보내기 위해서 일반적으로 `return 0;`을 메인함수의 반환값으로 두는 것이다. 오래된 컴파일러는 void main()을 허용하기도 하지만, 원칙적으로는 잘못된 것이다.



#### 참고: main(void)

**C11 표준에서 공식적으로 인정하는 진입점 선언문은 `int main(void)`와 `int main(int argc, char *argv[])`두 가지 뿐이다.** 즉 `int main()`은 비표준이나 마이크로소프트 등에서는 오히려 `int main() `구문을 사용하고 있다. 진입점 함수를 재귀적으로 불러오는 것 또한 표준에 어긋나니 큰 문제는 없겠지만, 표준 구문을 사용하는 것이 바람직할 것이다.



### 3. 함수의 값 반환

- 함수의 호출 부분으로 값을 반환
- `return [value]`
  - 함수를 종료하고 value값을 부모함수에 반환하며 즉시 복귀
  - 반환의 다양한 형태
    - `return 0;`
    - `return 3 * 5;`
      - 연산 결과 반환
    - `return 1 > 5;`
      - 관계 연산 결과 반환
    - `return;`
      - 반환 값이 없는 경우(`void function()`일 경우, return은 적어주면 좋다.)
- 함수 정의 시 함수명 앞에 return 자료형을 생략하면 **함수는 int형이 반환되는 것으로 간주**함

### 4. 함수 예제

```c
#include <stdio.h>
#define PI 3.14159

// 키보드로부터 반지름을 입력받아 원의 넓이, 원의 둘레를 구하여 출력

double getBorder(int radius);
double getArea(int radius);

int main() {
	int radius;
	double area;
	double border;

	printf("반지름?");
	scanf("%d%*c", &radius);
	
	border = getBorder(radius);
	area = getArea(radius);

	printf("원의 넓이 : %.4lf \n", area);
	printf("원의 둘레 : %.4lf \n", border);

	return 0;
}

double getBorder(int radius) {
	return radius * 2 * PI;
}

double getArea(int radius) {
	return radius * radius * PI;
}
```



## 3. 함수 선언의 이유

1. 호출되는 함수의 정의부가 호출하는 함수의 정의부보다 뒤에 있을 경우

   - 예를 들면, main()함수 뒤에 자식 함수들이 뒤따를 경우

   - 함수는 **호출하기 전** 함수 선언을 통해 함수의 원형(Protype)을 컴파일러에게 알려야 한다.

     - 함수 선언은 `자료형 함수명(매개변수자료형 매개변수명, ...)`과 같이 한다.
     - 만약 선언을 생략하면 컴파일러는 인자와 반환값을 int라고 정의하고 해당하는 메모리를 준비

     - 실제 인자와, 컴파일러가 계획한 인자가 다르면 제대로 된 리턴값이 나오지 않거나, 프로그램 실행 도중 오류가 발생한다.

2. 호출되는 함수의 정의부가 호출하는 함수의 정의부보다 앞에 있을 경우

   - 함수를 **호출하기 전** 정의된다면 컴파일러는 해당 함수의 반환형과 인수의 자료형을 알고 있으므로, 문제가 생기지 않는다.
   - 따라서 함수의 호출은 생략될 수 있다.

- 즉, 함수는 호출하기 전에 정의나 선언 중 하나를 해 주어야 한다.
- **하지만, 모든 코드의 최상단부에 함수 선언을 해 주는것이 안전하고, 그렇게 해 주어야 한다.**
  - main()만 자식 함수를 호출하는 것이 아니기 때문에, 여러 개의 함수가 중첩되면 꼬일 수 있다.

```c
// 컴파일 경고 메시지(컴파일은 성공)후 값이 제대로 뽑히지 않음
#include <stdio.h>

int main(void) {
	int i, j;
	i = 3;
	j = 5;
	printf("SWAP 이전 : i : %d, j : %d \n", i, j);
	swap(i); // swap(i, j); 에서 하나가 누락되었다 가정
	printf("SWAP 이후 : i : %d, j : %d \n", i, j);

	return 0;
}

int swap(int a, int b) {
	int temp = a;
	a = b;
	b = temp;
	
	return 0;
}
```

```c
// 컴파일 경고 메시지(컴파일은 성공)후 오류 발생
#include <stdio.h>
int main() {
	int i, j;
	i = 3;
	j = 5;
	printf("SWAP 이전 : i : %d, j : %d \n", i, j);
	swap(&i); // swap(&i, &j); 에서 하나가 누락되었다 가정
	printf("SWAP 이후 : i : %d, j : %d \n", i, j);

	return 0;
}
int swap(int* a, int* b) {
	int temp = *a;

	*a = *b;
	*b = temp;

	return 0;
}
```



### 1. 함수의 원형 사용의 이점

- 컴파일러에게 함수의 반환형을 알려줌.
- 컴파일러는 원형을 이용해 함수 호출에 사용되는 인수(== 인자)의 형과 매개변수의 형이 일치하는지 확인가능
- 컴파일러는 함수에 전달될 인자의 수가 매개변수의 수가 같은지 확인가능
- **정리하자면, 컴파일러는 위 항목들을 확인하고 잘못되었을 경우 컴파일 과정에서 적절한 에러 메세지를 발생시킨다**
  - ANSI C 표준안에서 함수 원형 사용이 의무화될 예정



### 2. 헤더파일 선언

- **시스템 헤더파일(~.h)**은 호출할 함수에 대한 **선언**이 들어있고, 함수에 대한 **정의는 라이브러리**로 구현해 놓은 것이 일반적인 관례이다.
- **라이브러리 함수는 사용(호출)하려면 함수**를 선언해야만 하는데, 호출할 **함수 원형이 헤더파일에 들어**있다.

```c
#include <stdio.h>
#include <math.h> // 선언하지 않으면, 정확한 결과를 보장받지 못한다.

int main(void) {
	int num;
	double result;

	printf("input number ? ");
	scanf("%d", &num);
	result = sqrt((double)num);
	printf("%d의 제곱근: %lf \n", num, result);

	return 0;
}
```

## 4. 재귀 함수

- C에서는 함수가 자신도 재 호출할 수 있다.
- 이것을 순환(rescursion) 또는 재귀 함수라 부른다.
